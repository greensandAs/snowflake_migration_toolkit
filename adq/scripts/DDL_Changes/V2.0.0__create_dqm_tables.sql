USE DATABASE {{ snowflake_database }};

USE SCHEMA {{ snowflake_schema }};

-- DDL for SEQUENCE: RUN_ID_SEQ
-- Extracted on: 2025-10-27 10:25:24
--------------------------------------------------------------------------------
CREATE SEQUENCE IF NOT EXISTS RUN_ID_SEQ START WITH 1 INCREMENT BY 1 ORDER;

-- DDL for TABLE: DQ_PROJECTS
-- Extracted on: 2025-10-27 10:24:42
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_PROJECTS (
    PROJECT_ID NUMBER(38, 0) NOT NULL,
    BU_NAME VARCHAR(16777216),
    APP_NAME VARCHAR(16777216),
    PROJECT_NAME VARCHAR(16777216),
    PROJECT_DESC VARCHAR(16777216),
    CREATED_BY VARCHAR(16777216),
    CREATED_TIMESTAMP TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP(),
    CONSTRAINT PK_DQ_PROJECTS PRIMARY KEY (PROJECT_ID)
);

-- DDL for TABLE: DQ_PROJECT_SCHEMA_MAPPING
-- Extracted on: 2025-10-27 10:24:43
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_PROJECT_SCHEMA_MAPPING (
    PROJECT_ID NUMBER(38, 0),
    DATABASE_NAME VARCHAR(16777216),
    SCHEMA_NAME VARCHAR(16777216),
    CREATED_AT TIMESTAMP_NTZ(9),
    UPDATED_AT TIMESTAMP_NTZ(9),
    DQ_ENABLED VARCHAR(10)

);
-- DDL for TABLE: DQ_TABLE_MASTER
-- Extracted on: 2025-10-27 10:24:45
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_TABLE_MASTER (
    TABLE_ID NUMBER(38, 0) NOT NULL,
    DATABASE_NAME VARCHAR(16777216),
    SCHEMA_NAME VARCHAR(16777216),
    TABLE_NAME VARCHAR(16777216),
    DQ_RESULTS_FORMAT VARCHAR(50),
    IS_ACTIVE BOOLEAN,
    CREATED_BY VARCHAR(100),
    CREATED_TIMESTAMP TIMESTAMP_NTZ(9),
    CONSTRAINT PK_DQ_TABLE_MASTER PRIMARY KEY (TABLE_ID)
);

-- DDL for TABLE: DQ_DATASET
-- Extracted on: 2025-10-27 10:24:35
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_DATASET (
    DATASET_ID NUMBER(38, 0) NOT NULL,
    PROJECT_ID NUMBER(38, 0),
    DATASET_TYPE VARCHAR(16777216),
    TABLE_ID NUMBER(38, 0),
    DATASET_NAME VARCHAR(16777216),
    PROJECT_NAME VARCHAR(16777216),
    DATABASE_NAME VARCHAR(16777216),
    SCHEMA_NAME VARCHAR(16777216),
    TABLE_NAME VARCHAR(16777216),
    CUSTOM_SQL VARCHAR(16777216),
    PRIMARY_KEY_COLUMNS VARCHAR(16777216),
    CANDIDATE_KEY_COLUMNS VARCHAR(16777216),
    DATASET_DESCRIPTION VARCHAR(16777216),
    CREATED_BY VARCHAR(16777216),
    CREATED_TIMESTAMP TIMESTAMP_NTZ(9),
    DATASIZE VARCHAR(255),
    LAYER VARCHAR(50),
    IS_INCREMENTAL BOOLEAN,
    FILTER_COND VARCHAR(16777216),
    SELECTED_COULMNS VARCHAR(16777216),
    FILTER_CONDITION VARCHAR(16777216),
    LIMIT_ROWS VARCHAR(16777216),
    INCR_DATE_COLUMN_1 VARCHAR(16777216),
    INCR_DATE_COLUMN_2 VARCHAR(16777216),
    DQ_RESULTS_FORMAT VARCHAR(16777216),
    CONSTRAINT PK_DQ_DATASET PRIMARY KEY (DATASET_ID)
);

-- DDL for TABLE: DQ_EXPECTATION_MASTER
-- Extracted on: 2025-10-27 10:24:39
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_EXPECTATION_MASTER (
    EXPECTATION_ID NUMBER(38, 0) NOT NULL,
    VALIDATION_NAME VARCHAR(10000),
    DESCRIPTION VARCHAR(10000),
    DIMENSION VARCHAR(16777216),
    IS_ACTIVE VARCHAR(16777216),
    CHECK_TYPE VARCHAR(100),
    SUB_DIMENSION VARCHAR(16777216),
    INSTRUCTION_TEXT VARCHAR(16777216),
    DQ_ENGINE VARCHAR(100),
    CONSTRAINT PK_DQ_EXPECTATION_MASTER PRIMARY KEY (EXPECTATION_ID)
);

-- DDL for TABLE: DQ_EXPECTATION_HANDLER_MAPPING
-- Extracted on: 2025-10-27 10:24:39
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_EXPECTATION_HANDLER_MAPPING (
    CHECK_TYPE VARCHAR(16777216),
    EXPECTATION_TYPE VARCHAR(16777216),
    SP_NAME VARCHAR(16777216),
    HANDLER_VERSION VARCHAR(16777216),
    IS_ACTIVE BOOLEAN,
    CREATED_AT TIMESTAMP_NTZ(9),
    UPDATED_AT TIMESTAMP_NTZ(9)

);

-- DDL for TABLE: DQ_EXPECTATION_ARGUMENTS
-- Extracted on: 2025-10-27 10:24:38
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_EXPECTATION_ARGUMENTS (
    EXPECTATION_ARG_ID NUMBER(38, 0) NOT NULL,
    EXPECTATION_ID NUMBER(38, 0),
    EXPECTATION_NAME VARCHAR(16777216),
    ARGUMENT_NAME VARCHAR(16777216),
    ARGUMENT_TYPE VARCHAR(16777216),
    ARGUMENT_DESC VARCHAR(16777216),
    IS_MANDATORY BOOLEAN,
    DEFAULT_VALUE VARCHAR(16777216),
    CONSTRAINT PK_DQ_EXPECTATION_ARGUMENTS PRIMARY KEY (EXPECTATION_ARG_ID)
);

-- DDL for TABLE: DQ_RULE_CONFIG
-- Extracted on: 2025-10-27 10:24:44
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_RULE_CONFIG (
    RULE_CONFIG_ID NUMBER(38, 0) NOT NULL,
    EXPECTATION_ID NUMBER(38, 0),
    DATASET_ID NUMBER(38, 0),
    NATURAL_LANG_RULE VARCHAR(16777216),
    CONVERSION_TYPE VARCHAR(16777216),
    EXPECTATION_NAME VARCHAR(16777216),
    EXPECTATION_TYPE VARCHAR(16777216),
    KWARGS VARCHAR(16777216),
    CREATED_BY VARCHAR(16777216),
    CREATED_TIMESTAMP TIMESTAMP_NTZ(9),
    DIMENSION VARCHAR(16777216),
    COLUMN_NAME VARCHAR(16777216),
    RULE_DESCRIPTION VARCHAR(16777216),
    REQUIRES_SQL VARCHAR(16777216),
    CUSTOM_SQL VARCHAR(16777216),
    CHECK_TYPE VARCHAR(16777216),
    CHECK_TYPE_DESC VARCHAR(16777216),
    PREVIOUS_NO_OF_DAYS NUMBER(38, 0),
    SEVERITY VARCHAR(100),
    DQ_ENGINE VARCHAR(100),
    RULE_TYPE VARCHAR(100),
    IS_ACTIVE BOOLEAN,
    CONSTRAINT PK_DQ_RULE_CONFIG PRIMARY KEY (RULE_CONFIG_ID)
);

-- DDL for TABLE: DQ_FAILED_RECORDS
-- Extracted on: 2025-10-27 10:24:40
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_FAILED_RECORDS (
    DATASET_RUN_ID NUMBER(38, 0),
    RULE_CONFIG_ID NUMBER(38, 0),
    FAILED_ROW VARIANT,
    LOAD_TIMESTAMP TIMESTAMP_NTZ(9)
);

-- DDL for TABLE: DQ_FAILED_ROW_KEYS
-- Extracted on: 2025-10-27 10:24:41
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_FAILED_ROW_KEYS (
    DATASET_RUN_ID NUMBER(38, 0),
    RULE_CONFIG_ID NUMBER(38, 0),
    DATABASE_NAME VARCHAR(16777216),
    SCHEMA_NAME VARCHAR(16777216),
    TABLE_NAME VARCHAR(16777216),
    FAILED_KEY VARIANT,
    LOAD_TIMESTAMP TIMESTAMP_NTZ(9) DEFAULT CURRENT_TIMESTAMP()
);
-- DDL for TABLE: DQ_JOB_EXEC_CONFIG
-- Extracted on: 2025-10-27 10:24:42
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_JOB_EXEC_CONFIG (
    DQ_DB_NAME VARCHAR(16777216),
    DQ_SCHEMA_NAME VARCHAR(16777216),
    SAMPLE_ROWS_CNT VARCHAR(16777216),
    SUCCESS_CODE VARCHAR(16777216),
    FAILED_CODE VARCHAR(16777216),
    EXECUTION_ERROR VARCHAR(16777216),
    CREATED_AT TIMESTAMP_NTZ(9),
    UPDATED_AT TIMESTAMP_NTZ(9)
);
-- DDL for TABLE: DQ_RULE_AUDIT_LOG
-- Extracted on: 2025-10-27 10:24:43
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_RULE_AUDIT_LOG (
    LOG_ID NUMBER(38, 0) NOT NULL AUTOINCREMENT START 1 INCREMENT 1 NOORDER,
    DATASET_RUN_ID NUMBER(38, 0) NOT NULL,
    RULE_CONFIG_ID NUMBER(38, 0),
    PROCEDURE_NAME VARCHAR(255) NOT NULL,
    STEP_NAME VARCHAR(255) NOT NULL,
    LOG_MESSAGE VARCHAR(16777216),
    START_TIMESTAMP TIMESTAMP_NTZ(9) NOT NULL,
    END_TIMESTAMP TIMESTAMP_NTZ(9),
    STATUS VARCHAR(50) NOT NULL,
    ERROR_MESSAGE VARCHAR(16777216),
    PRIMARY KEY (LOG_ID)
);

-- DDL for TABLE: DQ_RULE_RESULTS
-- Extracted on: 2025-10-27 10:24:44
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_RULE_RESULTS (
    BATCH_ID NUMBER(38, 0),
    DATASET_RUN_ID NUMBER(38, 0),
    DATASET_ID NUMBER(38, 0),
    RULE_CONFIG_ID NUMBER(38, 0),
    EXPECTATION_ID NUMBER(38, 0),
    RUN_NAME VARCHAR(16777216),
    RUN_TIMESTAMP TIMESTAMP_NTZ(9),
    DATASET_NAME VARCHAR(16777216),
    EXPECATION_CONFIG VARIANT,
    IS_SUCCESS BOOLEAN,
    RESULTS VARIANT,
    EXPECTATION_NAME VARCHAR(16777216),
    DETAILS VARIANT,
    ELEMENT_COUNT NUMBER(38, 0),
    MISSING_COUNT NUMBER(38, 0),
    MISSING_PERCENT NUMBER(38, 0),
    OBSERVED_VALUE VARIANT,
    PARTIAL_UNEXPECTED_COUNTS VARIANT,
    PARTIAL_UNEXPECTED_INDEX_LIST VARIANT,
    PARTIAL_UNEXPECTED_LIST VARIANT,
    UNEXPECTED_COUNT NUMBER(38, 0),
    UNEXPECTED_PERCENT FLOAT,
    UNEXPECTED_PERCENT_NONMISSING FLOAT,
    UNEXPECTED_PERCENT_TOTAL FLOAT,
    UNEXPECTED_ROWS VARIANT,
    DATA_ROWS VARIANT,
    USER VARCHAR(16777216),
    DIMENSION VARCHAR(16777216)
);

-- DDL for TABLE: DQ_DATASET_RUN_LOG
-- Extracted on: 2025-10-27 10:24:37
--------------------------------------------------------------------------------
CREATE OR REPLACE TABLE DQ_DATASET_RUN_LOG (
    DATASET_RUN_ID NUMBER(38, 0) NOT NULL,
    BATCH_ID NUMBER(38, 0),
    DATASET_ID NUMBER(38, 0),
    RUN_TIME NUMBER(38, 4),
    EVALUATED_EXPECTATIONS NUMBER(38, 0),
    SUCCESSFULL_EXPECTATIONS NUMBER(38, 0),
    UNSUCCESSFULL_EXPECTATIONS NUMBER(38, 0),
    RUN_STATUS VARCHAR(16777216),
    CREATED_BY VARCHAR(16777216),
    SUCCESS_PERCENT NUMBER(7, 4),
    CREATED_TIMESTAMP TIMESTAMP_NTZ(9),
    JSON_RESULTS VARIANT,
    MAX_VALIDATED_TIMESTAMP TIMESTAMP_NTZ(9),
    CONSTRAINT PK_DQ_DATASET_RUN_LOG PRIMARY KEY (DATASET_RUN_ID)
);
